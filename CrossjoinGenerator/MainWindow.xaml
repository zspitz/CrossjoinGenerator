<Window x:Class="CrossjoinGenerator.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:CrossjoinGenerator"
        xmlns:util="clr-namespace:Util;assembly=Util"
        Title="MainWindow"
        FlowDirection="RightToLeft"
        Width="600"
>
    <Window.Resources>
        <util:TruthyBooleanConverter x:Key="TruthyBooleanConverter" />
    </Window.Resources>
    
    <util:AutoGrid Columns="*" Rows="Auto,Auto,Auto,*" Orientation="Vertical" ChildMargin="5">
        <DockPanel>
            <TextBlock Margin="0,0,5,0">קובץ:</TextBlock>
            <TextBox FlowDirection="LeftToRight" Name="filename" />
        </DockPanel>
        <UniformGrid Columns="4" Rows="1">
            <Button>יצירת תבנית</Button>
            <Button Name="chooseFile">בחר נתיב הקובץ</Button>
            <Button Name="openFile" IsEnabled="{Binding Text, ElementName=filename, Converter={StaticResource TruthyBooleanConverter}}">פתח קובץ לעריכה</Button>
            <Button Name="start" IsEnabled="{Binding Text, ElementName=filename, Converter={StaticResource TruthyBooleanConverter}}">עיבוד קובץ</Button>
        </UniformGrid>

        <ProgressBar Name="progressBar" Height="20" VerticalAlignment="Top" />

        <TabControl>
            
            <TabItem Header="מבנה קובץ ה-Excel">
                <TextBlock xml:space="preserve">   
גליון בשם Grades המכיל את העמודות הבאות:
CurrentGrade - הכיתה (א1, ד2 וכו')
NewGrade - הכיתה אליו התלמיד עולה

גליון בשם Students המכיל את העמודות הבאות:
Name1 - שם משפחה
Name2 - שם פרטי
CurrentGrade - כיתה נוכחית (חייב להיות ערך מתוך העמודה CurrentGrade בדף Grades)

גליון בשם Items המכיל את העמודות הבאות:
NewGrade - הכיתה של שנה הבאה (חייב להיות ערך מתוך העמודה NewGrade בדף Grade)
Item - תאור הפריט
Price - מחיר
Type - סוג
Order - סדר הפריט בתוך הטופס
                </TextBlock>
            </TabItem>

            <TabItem Header="בדיקת נתונים">
                <DockPanel>
                    <TextBlock Name="message" Foreground="OrangeRed" DockPanel.Dock="Top" />
                    <DataGrid Name="invalidData" />
                </DockPanel>
            </TabItem>
            
        </TabControl>
    </util:AutoGrid>
</Window>
